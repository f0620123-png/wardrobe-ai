<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="theme-color" content="#fbf6ef" />
  <title>Wardrobe AI</title>

  <link rel="manifest" href="./manifest.webmanifest" />
  <link rel="icon" href="./icon-192.png" />
  <link rel="apple-touch-icon" href="./icon-192.png" />

  <link rel="stylesheet" href="./styles.css" />

  <style>
    /* minimal add-ons to ensure UI works even if styles.css missing some parts */
    .weatherBar{
      margin-top:12px;
      border:1px solid var(--stroke);
      background:rgba(255,255,255,.8);
      border-radius:18px;
      padding:12px;
      display:flex;
      gap:12px;
      align-items:flex-start;
      justify-content:space-between;
    }
    .weatherLeft{ min-width: 0; }
    .weatherTemp{ font-size:28px; font-weight:900; line-height:1; }
    .weatherFeels{ margin-top:6px; color:var(--muted); font-weight:800; }
    .weatherMeta{ margin-top:6px; color:var(--muted); font-size:12px; }
    .btnSmall{
      border:1px solid var(--stroke);
      background:#fff;
      border-radius:999px;
      padding:10px 12px;
      font-weight:900;
      white-space:nowrap;
    }
    .hintBox{
      margin-top:12px;
      border:1px solid var(--stroke);
      background:#fff;
      border-radius:18px;
      padding:12px;
    }
    .hintTitle{ font-weight:900; margin-bottom:8px; }
    .hintList{ margin:0; padding-left:18px; color:#444; }
    .hintList li{ margin:6px 0; }

    .skeleton{
      display:none;
      margin-top:12px;
      border:1px solid var(--stroke);
      background:rgba(255,255,255,.7);
      border-radius:18px;
      padding:12px;
    }
    .skLine{
      height:12px;
      border-radius:10px;
      background:rgba(0,0,0,.06);
      margin:10px 0;
      overflow:hidden;
      position:relative;
    }
    .skLine::after{
      content:"";
      position:absolute; inset:0;
      transform:translateX(-60%);
      background:linear-gradient(90deg, transparent, rgba(255,255,255,.65), transparent);
      animation:shine 1.1s infinite;
    }
    @keyframes shine{ to { transform:translateX(60%);} }

    .toast{
      position:fixed;
      left:50%;
      transform:translateX(-50%);
      bottom:calc(100px + env(safe-area-inset-bottom));
      background:rgba(0,0,0,.82);
      color:#fff;
      padding:10px 14px;
      border-radius:999px;
      font-weight:800;
      font-size:13px;
      opacity:0;
      pointer-events:none;
      transition:opacity .18s ease;
      z-index:999;
      max-width:min(560px, calc(100vw - 32px));
      text-align:center;
    }
    .toast.show{ opacity:1; }
  </style>
</head>

<body>
  <main class="app" id="app">
    <!-- Header -->
    <header class="header">
      <div class="brand">WARDROBE AI</div>
      <h1>今日穿搭</h1>
      <div class="sub">定位抓取體感溫度，提供穿搭建議；你也能自選單品合成示意圖（後續接 AI 產圖）。</div>

      <!-- Weather -->
      <section class="weatherBar" aria-label="天氣資訊">
        <div class="weatherLeft">
          <div class="weatherTemp" id="tempText">--°C</div>
          <div class="weatherFeels" id="feelsText">體感 --°C</div>
          <div class="weatherMeta" id="metaText">等待定位…</div>
        </div>
        <div class="weatherRight">
          <button class="btnSmall" id="btnLocate" type="button">定位/更新天氣</button>
        </div>
      </section>

      <section class="skeleton" id="weatherSkeleton" aria-hidden="true">
        <div class="skLine" style="width:42%"></div>
        <div class="skLine" style="width:72%"></div>
        <div class="skLine" style="width:58%"></div>
      </section>

      <section class="hintBox" aria-label="穿搭建議">
        <div id="outfitHint">
          <div class="hintTitle">尚未取得天氣</div>
          <ul class="hintList">
            <li>點「定位/更新天氣」取得體感溫度與建議。</li>
          </ul>
        </div>
      </section>
    </header>

    <!-- Chips (filters) -->
    <nav class="chips" aria-label="分類篩選">
      <button class="chip on" type="button" data-filter="all">全部</button>
      <button class="chip" type="button" data-filter="top">上衣</button>
      <button class="chip" type="button" data-filter="bottom">下身</button>
      <button class="chip" type="button" data-filter="outer">外套</button>
      <button class="chip" type="button" data-filter="shoes">鞋子</button>
      <button class="chip" type="button" data-filter="accessory">配件</button>
    </nav>

    <!-- Grid -->
    <section aria-label="單品列表">
      <div class="grid" id="grid">
        <!-- cards will be rendered by your existing app logic (localStorage items) -->
      </div>

      <div class="empty" id="empty" style="display:none;">
        尚無單品。點右下角「+」新增，或用「快速加入」先建立範例。
      </div>
    </section>
  </main>

  <!-- Floating Action Button -->
  <button class="fab" id="fab" type="button" aria-label="新增">
    +
  </button>

  <!-- Floating Menu -->
  <div class="menu" id="menu" style="display:none;" role="menu" aria-label="新增選單">
    <button type="button" id="menuPickPhoto" role="menuitem">照片圖庫</button>
    <button type="button" id="menuTakePhoto" role="menuitem">拍照</button>
    <button type="button" id="menuQuickAdd" role="menuitem">快速加入</button>
    <button type="button" id="menuClose" role="menuitem" class="danger">關閉</button>
  </div>

  <!-- Modal (Add/Edit) -->
  <div class="modal" id="modal" style="display:none;" role="dialog" aria-modal="true" aria-label="編輯單品">
    <div class="modalCard">
      <div class="modalHead">
        <div class="modalTitle" id="modalTitle">新增單品</div>
        <button class="iconBtn" id="modalClose" type="button" aria-label="關閉">✕</button>
      </div>

      <div class="field">
        <div class="label">名稱（示意）</div>
        <input class="input" id="itemName" placeholder="例如：白色短袖 T / 牛仔外套" />
      </div>

      <div class="field">
        <div class="label">分類</div>
        <div class="catGrid" id="catGrid">
          <button class="catBtn on" type="button" data-cat="top">上衣</button>
          <button class="catBtn" type="button" data-cat="bottom">下身</button>
          <button class="catBtn" type="button" data-cat="outer">外套</button>
          <button class="catBtn" type="button" data-cat="shoes">鞋子</button>
        </div>
      </div>

      <div class="field">
        <div class="label">備註</div>
        <textarea class="input" id="itemNote" rows="3" placeholder="示意：材質/顏色/版型/場合…"></textarea>
      </div>

      <button class="btnPrimary" id="modalSave" type="button">儲存</button>
      <button class="btnDanger" id="modalDelete" type="button">刪除</button>
    </div>
  </div>

  <!-- Bottom Nav -->
  <nav class="bottomNav" aria-label="底部導覽">
    <button class="on" type="button" data-tab="wardrobe">衣櫃</button>
    <button type="button" data-tab="outfit">穿搭</button>
    <button type="button" data-tab="settings">設定</button>
  </nav>

  <!-- Toast -->
  <div class="toast" id="toast" role="status" aria-live="polite"></div>

  <!-- App -->
  <script defer src="./app.js"></script>

  <!-- Service Worker -->
  <script>
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("./sw.js").catch(()=>{});
    }
  </script>
</body>
</html>